(self.webpackChunkva_auth_main=self.webpackChunkva_auth_main||[]).push([[968],{2473:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("va-main-content",[i("div",{staticClass:"va-main-content-header"},[i("div",{staticStyle:{flex:"1"}}),e._v(" "),i("div",[i("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-refresh"},on:{click:e.search}},[e._v("刷新")]),e._v(" "),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["menus:add"],expression:"['menus:add']"}],attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新增")])],1)]),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"va-menu-tree-header va-table-thead-theme"},[i("div",{staticClass:"va-menu-tree-node"},[i("span",[e._v("菜单名称")]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-header-title"},[i("span",[e._v("类型")]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span"},[e._v("权限标识")]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span"},[e._v("组件")]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span"},[e._v("路径")]),e._v(" "),i("span",[e._v("排序")]),e._v(" "),i("span",[e._v("可见")]),e._v(" "),i("span",[e._v("图标")]),e._v(" "),i("span",{staticStyle:{width:"140px"}},[e._v("操作")])])])]),e._v(" "),i("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tree",staticClass:"va-menu-tree",attrs:{data:e.menus,"node-key":"id","expand-on-click-node":!1,accordion:!0,"default-expanded-keys":e.defExKeys},on:{"node-expand":e.onNodeExpand,"node-collapse":e.onNodeCollapse},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.data;return i("div",{staticClass:"va-menu-tree-node"},[i("span",[e._v(e._s(s.title))]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-header-title"},[i("span",[e._v(e._s(e._f("MenuType")(s.type)))]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span",attrs:{title:s.permission}},[e._v(e._s(s.permission))]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span",attrs:{title:s.component}},[e._v(e._s(s.component))]),e._v(" "),i("span",{staticClass:"va-menu-tree-node-span",attrs:{title:s.path}},[e._v(e._s(s.path))]),e._v(" "),i("span",[e._v(e._s(s.sort))]),e._v(" "),i("span",{style:{color:s.display?"#67c23a":"#e6a23c"}},[e._v(e._s(s.display?"是":"否"))]),e._v(" "),i("span",[i("i",{class:s.icon})]),e._v(" "),i("span",{staticStyle:{width:"140px"}},[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["menus:edit"],expression:"['menus:edit']"}],attrs:{icon:"el-icon-edit",type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.edit(s)}}},[e._v("编辑")]),e._v(" "),i("el-popconfirm",{directives:[{name:"permission",rawName:"v-permission",value:["menus:del"],expression:"['menus:del']"}],staticStyle:{"margin-left":"10px"},attrs:{title:"确定永久删除该菜单吗？"},on:{confirm:function(t){return e.del(s)}}},[i("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-delete",size:"mini"},slot:"reference"},[e._v("删除")])],1)],1)])])}}])}),e._v(" "),i("VaMenuSubmit",{ref:"VaMenuSubmit",attrs:{menus:e.menus,visible:e.submitFormDialog,form:e.form},on:{"update:visible":function(t){e.submitFormDialog=t},submit:e.submit}})],1)};s._withStripped=!0;var r=i(3633),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{"custom-class":"va-dialog-submit",top:"5vh",visible:e.visible,title:"菜单",width:"580px","close-on-click-modal":!1},on:{close:e.closeDialog}},[i("el-form",{ref:"submitForm",attrs:{model:e.submitForm,rules:e.rules,size:"small","label-width":"80px"}},[i("el-form-item",{attrs:{label:"菜单类型"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.submitForm.type,callback:function(t){e.$set(e.submitForm,"type",t)},expression:"submitForm.type"}},e._l(e.menuType,(function(t,s){return i("el-radio-button",{key:s,attrs:{label:s}},[e._v(e._s(t))])})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.menuType[e.submitForm.type]+"名称",prop:"title"}},[i("el-input",{attrs:{placeholder:e.menuType[e.submitForm.type]+"名称"},model:{value:e.submitForm.title,callback:function(t){e.$set(e.submitForm,"title",t)},expression:"submitForm.title"}})],1),e._v(" "),2!==e.submitForm.type?i("el-form-item",{attrs:{label:"路由地址",prop:"path"}},[i("el-input",{attrs:{placeholder:"路由地址"},model:{value:e.submitForm.path,callback:function(t){e.$set(e.submitForm,"path",t)},expression:"submitForm.path"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"上级目录",prop:"pid"}},[i("el-cascader",{ref:"menuCascader",staticStyle:{width:"100%"},attrs:{placeholder:"选择上级类目（默认为根目录）",options:e.menulist,props:{value:"id",label:"title",checkStrictly:!0,emitPath:!1,expandTrigger:"hover"}},on:{change:e.pidChange},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,r=t.data;return[i("span",[e._v(e._s(r.title))]),e._v(" "),s.isLeaf?e._e():i("span",[e._v(" ("+e._s(r.children.length)+") ")])]}}]),model:{value:e.submitForm.pid,callback:function(t){e.$set(e.submitForm,"pid",t)},expression:"submitForm.pid"}})],1),e._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!==e.submitForm.type,expression:"submitForm.type !== 2"}],attrs:{label:"菜单图标"}},[i("el-col",{attrs:{span:11}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"}},[i("el-input",{attrs:{placeholder:"请输入图标","suffix-icon":e.submitForm.icon},model:{value:e.submitForm.icon,callback:function(t){e.$set(e.submitForm,"icon",t)},expression:"submitForm.icon"}})],1)],1),e._v(" "),i("el-col",{attrs:{offset:1,span:12}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"菜单可见"}},[i("el-radio-group",{staticClass:"va-full-radio",model:{value:e.submitForm.display,callback:function(t){e.$set(e.submitForm,"display",t)},expression:"submitForm.display"}},[i("el-radio-button",{attrs:{label:!0}},[e._v("是")]),e._v(" "),i("el-radio-button",{attrs:{label:!1}},[e._v("否")])],1)],1)],1)],1),e._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.submitForm.type,expression:"submitForm.type === 1"}],attrs:{label:"组件名称"}},[i("el-col",{attrs:{span:11}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"}},[i("el-input",{attrs:{placeholder:"匹配组件内Name字段"},model:{value:e.submitForm.componentName,callback:function(t){e.$set(e.submitForm,"componentName",t)},expression:"submitForm.componentName"}})],1)],1),e._v(" "),i("el-col",{attrs:{offset:1,span:12}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"内嵌页面"}},[i("el-radio-group",{staticClass:"va-full-radio",model:{value:e.submitForm.iframe,callback:function(t){e.$set(e.submitForm,"iframe",t)},expression:"submitForm.iframe"}},[i("el-radio-button",{attrs:{label:!0}},[e._v("是")]),e._v(" "),i("el-radio-button",{attrs:{label:!1}},[e._v("否")])],1)],1)],1)],1),e._v(" "),!0===e.submitForm.iframe&&1===e.submitForm.type?i("el-form-item",{attrs:{label:"内嵌路径",prop:"iframeSrc"}},[i("el-input",{attrs:{placeholder:"内嵌路径"},model:{value:e.submitForm.iframeSrc,callback:function(t){e.$set(e.submitForm,"iframeSrc",t)},expression:"submitForm.iframeSrc"}})],1):e._e(),e._v(" "),1===e.submitForm.type?i("el-form-item",{attrs:{label:"组件路径"}},[i("el-input",{attrs:{placeholder:"组件路径"},model:{value:e.submitForm.component,callback:function(t){e.$set(e.submitForm,"component",t)},expression:"submitForm.component"}})],1):e._e(),e._v(" "),2!==e.submitForm.type?i("el-form-item",{attrs:{label:"页面结构",prop:"layout"}},[i("el-col",{attrs:{span:11}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{prop:"layout"}},[i("el-select",{attrs:{placeholder:"选择页面的结构样式"},model:{value:e.submitForm.layout,callback:function(t){e.$set(e.submitForm,"layout",t)},expression:"submitForm.layout"}},e._l([{name:"默认",value:"default"},{name:"无样式（例：登录页面）",value:""}],(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),e._v(" "),i("el-col",{attrs:{offset:1,span:12}},[i("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"菜单排序"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,"controls-position":"right"},model:{value:e.submitForm.sort,callback:function(t){e.$set(e.submitForm,"sort",e._n(t))},expression:"submitForm.sort"}})],1)],1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"权限标识"}},[i("el-input",{attrs:{placeholder:"权限标识"},model:{value:e.submitForm.permission,callback:function(t){e.$set(e.submitForm,"permission",t)},expression:"submitForm.permission"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"菜单描述"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"描述"},model:{value:e.submitForm.description,callback:function(t){e.$set(e.submitForm,"description",t)},expression:"submitForm.description"}})],1),e._v(" "),i("el-form-item",{staticStyle:{"text-align":"right"}},[i("el-button",{on:{click:function(t){return e.closeDialog()}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("submitForm")}}},[e._v(e._s(e.form&&e.form.id?"保存":"创建"))])],1)],1)],1)};a._withStripped=!0;const o={name:"va-menu-submit",props:["form","menus","visible"],data:function(){return{menuType:["目录","菜单","按钮"],submitForm:{type:0,title:"",path:"",layout:"default",component:"",componentName:"",iframe:!1,iframeSrc:"",pid:1,icon:"",display:!1,sort:1,permission:"",description:""},rules:{title:[{required:!0,message:"请输入名称",trigger:"blur"}],path:[{required:!0,message:"请输入地址",trigger:"blur"}],pid:[{required:!0,message:"请输入上级目录",trigger:"blur"}],layout:[{required:!0,message:"请选择页面结构",trigger:"blur"}],iframeSrc:[{required:!0,message:"请输入路径",trigger:"blur"}]},menulist:[]}},watch:{form:function(){this.initform(),this.initMenuList()},menus:function(){this.initMenuList()}},mounted:function(){this.initMenuList()},methods:{submit:function(){var e=this;this.$refs.submitForm.validate((function(t){if(t){var i={};for(var s in e.submitForm)if(Object.prototype.hasOwnProperty.call(e.submitForm,s)){if(e.form&&e.form.id&&e.form[s]===e.submitForm[s])continue;i[s]=e.submitForm[s]}e.form&&e.form.id&&(i.id=e.form.id),0===Object.keys(i).length?e.$emit("update:visible",!1):e.$emit("submit",i)}}))},initMenuList:function(){this.menulist=[{id:1,title:"根级目录"}].concat(this.menus)},initform:function(){if(this.$refs.submitForm&&this.$refs.submitForm.clearValidate(),this.form)for(var e in this.submitForm)Object.prototype.hasOwnProperty.call(this.submitForm,e)&&(this.submitForm[e]=this.form[e]);else this.resetSubmitForm()},resetSubmitForm:function(){this.submitForm={type:0,title:"",path:"",layout:"default",component:"",componentName:"",iframe:!1,iframeSrc:"",pid:1,icon:"",display:!1,sort:1,permission:"",description:""}},closeDialog:function(){this.$emit("update:visible",!1)},pidChange:function(){var e=this.$refs.menuCascader.getCheckedNodes();e.length>0&&(e[0].data.children?this.submitForm.sort=100*e[0].data.sort+e[0].data.children.length+1:this.submitForm.sort=100*e[0].data.sort+1)}}};var n=i(1900),l=(0,n.Z)(o,a,[],!1,null,null,null);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}l.options.__file="src/auth/views/system/component/menuSubmit.vue";const u={name:"va-menus",components:{VaMenuSubmit:l.exports},filters:{MenuType:function(e){return 0===e?"目录":1===e?"菜单":"按钮"}},data:function(){return{menus:[],form:null,defExKeys:[],defNodeExpandId:"",loading:!0,submitFormDialog:!1,menuType:["目录","菜单","按钮"]}},mounted:function(){this.search()},methods:{search:function(){var e=this;this.loading=!0,this.$authApi.GetAllMenus().then((function(t){t.err?e.$message.error(t.err):(e.menus=(0,r.e9)(t),e.defNodeExpandId&&(e.defExKeys=[e.defNodeExpandId])),e.loading=!1})).catch((function(){return e.loading=!1}))},onNodeExpand:function(e){this.defNodeExpandId=e.id},onNodeCollapse:function(e){e.id===this.defNodeExpandId&&(this.defNodeExpandId="")},edit:function(e){this.form=e,this.submitFormDialog=!0},del:function(e){var t=this,i=[];!function e(t){var s,r=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return m(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,n=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){n=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(n)throw a}}}}(t);try{for(r.s();!(s=r.n()).done;){var a=s.value;i.push(a.id),Array.isArray(a.children)&&e(a.children)}}catch(e){r.e(e)}finally{r.f()}}([e]),this.$authApi.DelMenu(i).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.search()}))},add:function(){this.form=null,this.submitFormDialog=!0},submit:function(e){var t=this;e.id?this.$authApi.EditMenu(e).then((function(e){t.$message.success("保存成功"),t.search(),t.submitFormDialog=!1})):this.$authApi.AddMenu(e).then((function(e){t.$message.success("添加成功"),t.search(),t.submitFormDialog=!1,t.$refs.VaMenuSubmit.resetSubmitForm()}))}}};var c=(0,n.Z)(u,s,[],!1,null,null,null);c.options.__file="src/auth/views/system/menus.vue";const p=c.exports}}]);