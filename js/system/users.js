(self.webpackChunkva_auth_main=self.webpackChunkva_auth_main||[]).push([[5],{4073:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("va-main-content",[s("div",{staticClass:"va-main-content-header"},[s("el-input",{staticClass:"va-system-bt-search",attrs:{size:"small",clearable:"",placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),e._v(" "),s("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v("搜索")]),e._v(" "),s("div",{staticStyle:{flex:"1"}}),e._v(" "),s("div",{directives:[{name:"permission",rawName:"v-permission",value:["users:add"],expression:"['users:add']"}]},[s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新增")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"va-table-thead-theme",staticStyle:{"padding-left":"5px"},attrs:{data:e.data}},[s("el-table-column",{attrs:{prop:"name",label:"昵称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"account",label:"用户名"}}),e._v(" "),s("el-table-column",{attrs:{prop:"phone",label:"电话"}}),e._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"email",label:"邮箱"}}),e._v(" "),s("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#67C23A","inactive-color":"#F56C6C"},on:{change:function(s){return e.changeEnabled(t.row,t.row.state)}},model:{value:t.row.state,callback:function(s){e.$set(t.row,"state",s)},expression:"scope.row.state"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"createTime",label:"创建日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("vaParseTime")(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"185",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["users:edit"],expression:"['users:edit']"}],attrs:{icon:"el-icon-edit",size:"mini",type:"text"},on:{click:function(s){return e.edit(t.row)}}},[e._v("\n                    编辑\n                ")]),e._v(" "),s("el-popconfirm",{directives:[{name:"permission",rawName:"v-permission",value:["users:del"],expression:"['users:del']"}],staticStyle:{"margin-left":"10px"},attrs:{title:"确定永久删除该用户吗？"},on:{confirm:function(s){return e.remove(t.row)}}},[s("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-delete",size:"mini"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),s("el-pagination",{staticStyle:{padding:"20px",background:"#fff","text-align":"center"},attrs:{background:"","current-page":e.page,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.sizeChange,"current-change":e.pageChange}}),e._v(" "),s("el-dialog",{attrs:{"custom-class":"va-dialog-submit",visible:e.submitFormDialog,width:"580px",title:"用户","close-on-click-modal":!1},on:{"update:visible":function(t){e.submitFormDialog=t}}},[s("el-form",{ref:"submitForm",attrs:{model:e.submitForm,rules:e.rules,size:"small","label-width":"80px"}},[e.submitForm.id?e._e():s("el-form-item",{attrs:{label:"登录名称",prop:"account"}},[s("el-input",{attrs:{placeholder:"请输入登录用户名"},model:{value:e.submitForm.account,callback:function(t){e.$set(e.submitForm,"account",t)},expression:"submitForm.account "}})],1),e._v(" "),s("el-form-item",{attrs:{label:"登录密码 ",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入登录密码"},model:{value:e.submitForm.password,callback:function(t){e.$set(e.submitForm,"password",t)},expression:"submitForm.password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"用户角色 ",prop:"roles"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.submitForm.roleId,callback:function(t){e.$set(e.submitForm,"roleId",t)},expression:"submitForm.roleId"}},e._l(e.roles,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"用户名称",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入用户名称"},model:{value:e.submitForm.name,callback:function(t){e.$set(e.submitForm,"name",t)},expression:"submitForm.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入用户邮箱"},model:{value:e.submitForm.email,callback:function(t){e.$set(e.submitForm,"email",t)},expression:"submitForm.email"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"电话",prop:"phone"}},[s("el-input",{attrs:{placeholder:"请输入用户电话"},model:{value:e.submitForm.phone,callback:function(t){e.$set(e.submitForm,"phone",t)},expression:"submitForm.phone"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"right"}},[s("el-button",{on:{click:function(t){e.submitFormDialog=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("保存")])],1)],1)],1)],1)};a._withStripped=!0;const i={name:"va-users",data:function(){return{total:1,page:1,pageSize:10,searchKey:"",loading:!1,submitFormDialog:!1,submitForm:{id:"",name:"",roleId:"",account:"",password:"",phone:"",email:""},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],account:[{required:!0,message:"请输入登录用户名",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],roleId:[{required:!0,message:"请选择用户角色",trigger:"blur"}],phone:[{validator:function(e,t,s){/^1[3|4|5|6|7|8]\d{9}$/.test(t)||!t?s():s(new Error("电话格式有误"))},trigger:"blur"}],email:[{validator:function(e,t,s){/^[\w_.]+@[\w-]+(\.[\w-]+)*\.[0-9a-zA-Z0]{2,6}$/.test(t)||!t?s():s(new Error("邮箱格式有误"))},trigger:"blur"}]},roles:[],currectUser:"",data:[]}},mounted:function(){this.search(),this.getRoles()},methods:{search:function(e){var t=this;this.loading=!0,this.$authApi.GetAllUsers({page:e||1,pageSize:this.pageSize,searchKey:this.searchKey}).then((function(e){t.data=e.list,t.total=e.total,t.loading=!1}))},getRoles:function(){var e=this;this.$authApi.GetAllRoles({page:1,pageSize:1e3}).then((function(t){e.roles=t.list}))},add:function(){this.$refs.submitForm&&this.$refs.submitForm.resetFields(),this.currectUser="",this.submitForm={id:"",name:"",roleId:"",account:"",password:"",phone:"",email:""},this.submitFormDialog=!0},edit:function(e){this.$refs.submitForm&&this.$refs.submitForm.resetFields(),this.currectUser=e,this.submitForm={id:e.id,name:e.name,roleId:e.roleId,account:e.account,password:e.password,phone:e.phone,email:e.email},this.submitFormDialog=!0},submit:function(){var e=this;this.$refs.submitForm.validate((function(t){if(t){var s={};if(e.submitForm.id){for(var a in e.submitForm)Object.hasOwnProperty.call(e.submitForm,a)&&e.currectUser[a]!==e.submitForm[a]&&(s[a]=e.submitForm[a]);0===Object.keys(s).length?e.submitFormDialog=!1:(s.id=e.submitForm.id,e.$authApi.EditUser(s).then((function(){e.submitFormDialog=!1,e.$message.success("操作成功"),e.search()})))}else Object.assign(s,e.submitForm),e.$authApi.AddUser(s).then((function(t){e.submitFormDialog=!1,e.$message.success("操作成功"),e.search()}))}}))},remove:function(e){var t=this;this.$authApi.DelUser({id:e.id}).then((function(){t.$message({type:"success",message:"删除成功!"}),t.search()}))},sizeChange:function(e){this.pageSize=e},pageChange:function(e){this.search(e)},changeEnabled:function(e,t){var s=this;this.$authApi.EditUser({id:e.id,state:t}).then((function(){s.$message.success("操作成功")}))}}};var r=(0,s(1900).Z)(i,a,[],!1,null,null,null);r.options.__file="src/auth/views/system/users.vue";const o=r.exports}}]);